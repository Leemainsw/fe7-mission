<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./reset.css" />
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
        }

        p {
            font-size: 14px;
            margin-bottom: 20px;
            text-align: center;
        }

        span {
            font-size: 12px;
        }

        .container {
            width: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .buttons {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        .buttons>button:not(:last-child) {
            margin-right: 10px;
        }

        ul {
            margin-top: 10px;
            width: 100%;
            padding: 20px;
            background-color: lightgray;
            display: grid;
            grid: auto-flow / repeat(3, 1fr);
            grid-gap: 10px;
            text-align: center;
        }

        ul>li {
            padding: 20px;
            background-color: white;
            border-radius: 10px;
        }

        ul>li:last-child {
            grid-column: 2;
        }
    </style>
    <title>Document</title>
</head>

<body>
    <!-- HTML 은 수정하지 않습니다. -->
    <div class="container">
        <h1>간단한 계산기</h1>
        <p>
            숫자를 2개 선택하고, 연산자를 선택하면<br />결과값이 alert으로
            출력됩니다.
        </p>

        <!-- 여기에 처음 선택한 숫자가 "First Number: 1" 형식의 텍스트로 보입니다.  -->
        <span class="firstNumber"></span>
        <!-- 여기에 두번째 선택한 숫자가 "Second Number: 2" 형식의 텍스트로 보입니다.  -->
        <span class="secondNumber"></span>
        <!-- 여기에 연산이 된 결과값이 "Result: 1 + 2 = 3" 형식의 텍스트로 보입니다.  -->
        <span class="result"></span>

        <ul></ul>

        <div class="buttons"></div>
    </div>

    <!-- 
        1. 처음 선택한 숫자가 `firstName` 에 담깁니다.
        2. 두번째 선택한 숫자가 `secondName` 에 담깁니다.
        3. 숫자 2개 전부 선택하지 않은 상태로 연산자 버튼을 클릭하면 `alert` 창에 `“숫자를 먼저 선택해주세요”` 라고 뜹니다.
        4. 반드시 숫자 2개를 먼저 선택한 후 연산자를 클릭해야 계산이 되어 결과값을 보여줍니다.
        5. 연산자 중 `/` 를 선택하면 결과값으로 `반올림`한 값을 보여줍니다.
        6. 계산 후 다시 숫자를 클릭하면 `firstName` 부터 담기며 다시 시작합니다. 
    -->

    <script>
        // 숫자 초기화용 값입니다. 초기화 시킬 때 이 친구를 사용해 주세요.
        const NUMBER_INITIAL_VALUE = -1;
        let firstNumber = NUMBER_INITIAL_VALUE;
        let secondNumber = NUMBER_INITIAL_VALUE;

        // 사용되는 숫자, 연산자 배열
        const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0];
        const operators = ["+", "-", "*", "/"];

        // 숫자 노출되는 elements
        const firstNumberSpan = document.querySelector(".firstNumber");
        const secondNumberSpan = document.querySelector(".secondNumber");
        const resultSpan = document.querySelector(".result");

        // 요소 삽입에 사용할, 부모 element 가져오기
        const ul = document.querySelector('ul');
        const buttons = document.querySelector('.buttons')

        // 두 숫자가 모두 입력되었는지 확인하는 함수
        function hasResult(fNumber, sNumber) {
            return fNumber !== NUMBER_INITIAL_VALUE && sNumber !== NUMBER_INITIAL_VALUE
        }

        // 값 초기화 및 화면에 노출되는 숫자 초기화
        function resetInputNumber() {
            firstNumber = NUMBER_INITIAL_VALUE
            secondNumber = NUMBER_INITIAL_VALUE

            firstNumberSpan.textContent = '';
            secondNumberSpan.textContent = '';
            resultSpan.textContent = '';
        }

        // 숫자 버튼 클릭 시, 실행되는 함수
        function numberButtonClickHandler(button) {
            const number = Number(button.textContent);
            if (Number.isNaN(number)) return;

            // 결과가 이미 노출되었고, 유저가 숫자를 한 번 더 입력했을 경우
            if (hasResult(firstNumber, secondNumber)) {
                // 초기화 함수 호출
                resetInputNumber();
            }

            if (firstNumber === NUMBER_INITIAL_VALUE) {
                firstNumber = number;
                firstNumberSpan.textContent = `First Number: ${number}`
                return;
            }


            if (secondNumber === NUMBER_INITIAL_VALUE) {
                secondNumber = number;
                secondNumberSpan.textContent = `Second Number: ${number}`
            }
        }

        // 숫자 화면에 노출하는 함수
        function showNumberButtons() {
            numbers.forEach(number => {
                const li = document.createElement('li');
                const button = document.createElement('button');
                button.textContent = number;
                li.appendChild(button);
                ul.appendChild(li);
            });
        }

        function getResult(operator, fNumber, sNumber) {
            switch (operator) {
                case '+': {
                    return fNumber + sNumber;
                }
                case '-': {
                    return fNumber - sNumber;
                }
                case '*': {
                    return fNumber * sNumber;
                }
                case '/': {
                    if (sNumber === 0) {
                        return null
                    }
                    return Math.round(fNumber / sNumber);
                }
                default:
                    return null;
            }

        }

        // 연산자 클릭 시, 실행되는 함수
        function operatorClickHandler(button) {
            const operator = button.textContent;

            if (firstNumber === NUMBER_INITIAL_VALUE || secondNumber === NUMBER_INITIAL_VALUE) {
                alert('숫자를 먼저 선택해주세요.')
                return;
            }

            // 5. 연산자 중 `/` 를 선택하면 결과값으로 `반올림`한 값을 보여줍니다.
            // 6. 계산 후 다시 숫자를 클릭하면 `firstName` 부터 담기며 다시 시작합니다. 
            let value = getResult(operator, firstNumber, secondNumber);
            if (value === null) {
                alert('0으로 나눌 수 없습니다.');
                resetInputNumber();
                return
            }

            resultSpan.textContent = `Result: ${firstNumber} ${operator} ${secondNumber} = ${value}`;
        }

        // 연산자 화면에 노출하는 함수
        function showOperatorButtons() {
            operators.forEach(operator => {
                const operatorButton = document.createElement('button');
                operatorButton.textContent = operator;
                buttons.appendChild(operatorButton)
            })
        }

        // 이벤트 위임을 통한 숫자 버튼 클릭 처리
        ul.addEventListener('click', (event) => {
            const btn = event.target.closest('button');
            if (!btn || !ul.contains(btn)) return;
            numberButtonClickHandler(btn);
        });

        // 이벤트 위임을 통한 연산자 버튼 클릭 처리
        buttons.addEventListener('click', (event) => {
            const btn = event.target.closest('button');
            if (!btn || !buttons.contains(btn)) return;
            operatorClickHandler(btn);
        });

        showNumberButtons();
        showOperatorButtons();

    </script>
</body>

</html>